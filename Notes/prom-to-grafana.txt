https://grafana.com/docs/grafana/latest/developer-resources/api-reference/http-api/examples/create-api-tokens-for-org/

https://grafana.com/docs/grafana/latest/alerting/alerting-rules/alerting-migration/

https://grafana.com/docs/mimir/latest/manage/tools/mimirtool/#rules

https://grafana.com/docs/mimir/latest/manage/secure/authentication-and-authorization/

Create a contact point:

curl -X POST \
  -H "Content-Type: application/json" \
  -u admin:prom-operator \
  "http://localhost:30081/api/v1/provisioning/contact-points" \
  -d '{
    "name": "Alert Receiver",
    "type": "email",
    "settings": {
      "addresses": "russueltengco@gmail.com"
    },
    "disableResolveMessage": false
  }'

Update the notification policy:

curl -X PUT \
  -H "Content-Type: application/json" \
  -H "X-Disable-Provenance=true" \
  -u admin:prom-operator \
  "http://localhost:30081/api/v1/provisioning/policies" \
  -d '{"receiver":"grafana-default-email","group_by":["grafana_folder","alertname"],"group_wait":"30s","group_interval":"5m","repeat_interval":"12h","routes":[{"receiver":"Alert Receiver","matchers":["type=alert"],"group_wait":"10s","repeat_interval":"1h"}]}'

Create a Prometheus rules YAML, but disregard the apiVersion, kind, spec. Start with "group" key

Then create a configmap, and embed the Prometheus rules into config map by running the following imperative commands.

kubectl create configmap prom-rules --from-file=<output filename>.yaml=<filename of prom rules>.yaml

Get the datasourceUID by running the command below:
curl -s -u "admin:prom-operator" localhost:30081/api/datasources

Create a Job Kubernetes resource to convert the Prometheus rules into Grafana managed-rules using mimirtool.

apiVersion: batch/v1
kind: Job
metadata:
  name: prom-to-gmr
  namespace: default
spec:
  template:
    spec:
      restartPolicy: Never
      containers:
        - name: mimirtool-load
          image: grafana/mimirtool:latest
          args:
            - rules
            - load
            - /rules/prometheus-rules.yaml
            - --address=http://172.18.0.2:30081/api/convert/
            - --user=admin
            - --key=prom-operator
            - --id=1
            - --extra-headers
            - X-Grafana-Alerting-Datasource-UID=$(DATASOURCE_UID)
            - --extra-headers
            - X-Disable-Provenance=true
          env:
            - name: DATASOURCE_UID
              value: "cfafzkmr6p9tsc" 
          volumeMounts:
            - name: rules
              mountPath: /rules
              readOnly: true
      volumes:
        - name: rules
          configMap:
            name: prom-rules


Delete the contact points curl -X DELETE   -u admin:prom-operator   "http://localhost:30081/api/v1/provisioning/contact-points/dfajng4tfbe9sf"